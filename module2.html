<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 2: The Serverless Backend</title>
    <script src="https://cdn.tailwindcss.com"></script>
        <script>
        // CRITICAL: This script must be in the <head> of EVERY page
        // It prevents a flash of the wrong theme on page load.
        if (localStorage.getItem('theme') === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .code-block { background-color: #1e293b; color: #e2e8f0; font-family: monospace; }
        .sorter-item { cursor: grab; }
        .sorter-bin { min-height: 100px; }
        .drag-over { background-color: #e0e7ff; border-style: dashed; }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <header class="bg-white shadow-sm border-b border-stone-200 sticky top-0 z-40">
        <div class="container mx-auto px-4 sm:px-6 md:px-8 py-4 flex justify-between items-center">
            <a href="dashboard.html" class="text-xl font-bold text-stone-900">Learning Experience Forge</a>
            <div class="flex items-center gap-4">
                <div class="relative">
                    <button id="notifications-btn" class="relative">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-stone-500 hover:text-stone-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg>
                    </button>
                    <div id="notifications-dropdown" class="hidden absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border border-stone-200 overflow-hidden">
                        <div class="p-3 font-bold text-sm border-b">Notifications</div>
                    </div>
                </div>
                <div class="relative">
                    <button id="profile-btn" class="flex items-center gap-2">
                        <span id="user-email" class="text-sm text-stone-600 hidden sm:block"></span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-stone-400" fill="currentColor" viewBox="0 0 16 16"><path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/><path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/></svg>
                    </button>
                    <div id="profile-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-stone-200 overflow-hidden">
                        <a href="grades.html" class="block px-4 py-2 text-sm text-stone-700 hover:bg-stone-100">My Grades</a>
                        <a href="settings.html" class="block px-4 py-2 text-sm text-stone-700 hover:bg-stone-100">Settings</a>
                        <div class="border-t border-stone-200"></div>
                        <button id="logout-btn" class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-stone-100">Log Out</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        <header class="mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-stone-900">Module 2: The Serverless Backend</h1>
            <p class="text-stone-500 mt-2 text-lg">Your Course's Central Nervous System</p>
        </header>
        
        <div class="space-y-12">
            <section>
                <h2 class="text-2xl font-bold mb-4">Why a Backend is Non-Negotiable</h2>
                <p class="text-stone-600 mb-4">In Module 1, we focused on the frontend—what the user sees and interacts with. But for a learning experience to be meaningful, it needs **persistence**. A learner's progress, their grades, and their interactions must be saved and retrieved. This is the job of the backend.</p>
                <p class="text-stone-600">The backend is your application's brain and long-term memory. It handles everything the user can't see, from securely logging them in to saving their assessment scores in a database. Without it, every visit to your course would be a fresh start, with no memory of past achievements.</p>
            </section>

            <section>
                <h2 class="text-2xl font-bold mb-4">User Authentication: The Secure Front Door</h2>
                 <p class="text-stone-600 mb-4">Before you can save a student's progress, you need to know who they are. This is authentication. Building a secure login system from scratch is incredibly difficult and risky. This is why we use a dedicated service like **Firebase Authentication**. It handles the complexities of security so you can focus on the learning experience.</p>
                <p class="text-stone-600 mb-4">When a user signs up, Firebase doesn't just store their password. It performs a one-way cryptographic function called **hashing**. The result, a long, unique string, is stored—not the password itself. When the user logs in, Firebase hashes the entered password and compares it to the stored hash. Because this is a one-way process, even if a database is compromised, the actual passwords remain secret. Upon successful login, Firebase gives the user a temporary, secure **token** (a JWT), which acts as their ID card for all future requests, proving who they are without sending their password over and over.</p>
                
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200 mt-8">
                    <h3 class="font-bold text-lg mb-4 text-center">Formative Quiz: Security Best Practices Sorter</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-start">
                        <!-- Bins -->
                        <div>
                            <h4 class="font-semibold text-center mb-2 text-green-700">Good Practice</h4>
                            <div id="good-bin" class="sorter-bin bg-green-50 border-2 border-green-200 rounded-lg p-4 space-y-2"></div>
                        </div>
                        <div>
                            <h4 class="font-semibold text-center mb-2 text-red-700">Bad Practice</h4>
                            <div id="bad-bin" class="sorter-bin bg-red-50 border-2 border-red-200 rounded-lg p-4 space-y-2"></div>
                        </div>
                    </div>
                    <!-- Items to be Sorted -->
                    <div id="items-container" class="mt-6 flex flex-wrap gap-3 justify-center">
                        <div class="sorter-item bg-white p-3 rounded-lg shadow-sm border cursor-grab" draggable="true" data-bin="good">Using a service like Firebase Auth</div>
                        <div class="sorter-item bg-white p-3 rounded-lg shadow-sm border cursor-grab" draggable="true" data-bin="bad">Storing passwords in plain text</div>
                        <div class="sorter-item bg-white p-3 rounded-lg shadow-sm border cursor-grab" draggable="true" data-bin="good">Password hashing</div>
                        <div class="sorter-item bg-white p-3 rounded-lg shadow-sm border cursor-grab" draggable="true" data-bin="bad">Using a secret API key in frontend code</div>
                        <div class="sorter-item bg-white p-3 rounded-lg shadow-sm border cursor-grab" draggable="true" data-bin="good">Using secure tokens (JWTs)</div>
                    </div>
                    <div class="text-center mt-6">
                        <button id="check-sorter-btn" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition">Check Answers</button>
                        <p id="sorter-feedback" class="mt-4 text-sm font-medium"></p>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="text-2xl font-bold mb-4">A Note on SCORM: The Old vs. The New</h2>
                <p class="text-stone-600 mb-4">Many in the e-learning world are familiar with **SCORM** (Sharable Content Object Reference Model). At its core, SCORM is simply a set of technical standards that defines how a piece of e-learning content (the "SCO") communicates with a Learning Management System (LMS). This communication happens through a frontend JavaScript API. When you complete a quiz in a SCORM package, the content uses a JavaScript call like `LMSSetValue('cmi.core.score.raw', '85')` to tell the LMS your score.</p>
                <p class="text-stone-600 mb-4">The skills you are learning in this course make you **more than competent** to work with SCORM. By mastering how to build interactive web components and communicate with a backend, you are learning the fundamental principles that SCORM itself is built on. You could easily prompt an AI to create a simple quiz and then add the necessary JavaScript SCORM calls to make it compliant if a project required it.</p>
                <p class="text-stone-600 font-semibold">However, the modern, serverless backend approach offers a far more robust and effective system.</p>
                <ul class="list-disc list-inside text-stone-600 space-y-2">
                    <li><strong>Richer Data:</strong> SCORM is limited to tracking predefined data points (e.g., completion, score, time). With a modern backend like Firestore, you can track anything: every click, every choice in a scenario, time spent on a specific interaction, etc. This provides infinitely richer data for learning analytics.</li>
                    <li><strong>Flexibility and Independence:</strong> Your application is not tied to an LMS. It can function as a standalone platform, giving you complete control over the user experience.</li>
                    <li><strong>Real-Time Interaction:</strong> Features like a live message board are simply not possible with the SCORM standard. A serverless backend enables dynamic, community-based learning experiences.</li>
                </ul>
            </section>

             <section class="text-center py-10">
                 <a href="fa2.html" class="px-8 py-4 bg-indigo-600 text-white font-semibold rounded-lg shadow-md hover:bg-indigo-700 transition text-lg">
                    Take Summative Assessment
                </a>
            </section>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

        const firebaseConfig = {
             apiKey: "AIzaSyDWpBbBLpq2fOnN5-EO3kmc0CHyG7DHXIM",
            authDomain: "elearning-e83cb.firebaseapp.com",
            projectId: "elearning-e83cb",
            storageBucket: "elearning-e83cb.appspot.com",
            messagingSenderId: "25473938624",
            appId: "1:25473938624:web:5b56738933543f32a7e925",
            measurementId: "G-R713G5DD1S"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        // --- Auth Guard ---
        onAuthStateChanged(auth, user => {
            if (!user) {
                window.location.href = '/Login.html';
            } else {
                 userEmailEl.textContent = user.email;
            }
        });
        
        // --- Navbar Logic ---
        const userEmailEl = document.getElementById('user-email');
        const logoutBtn = document.getElementById('logout-btn');
        const profileBtn = document.getElementById('profile-btn');
        const profileDropdown = document.getElementById('profile-dropdown');
        const notificationsBtn = document.getElementById('notifications-btn');
        const notificationsDropdown = document.getElementById('notifications-dropdown');
        profileBtn.addEventListener('click', (e) => { e.stopPropagation(); profileDropdown.classList.toggle('hidden'); });
        notificationsBtn.addEventListener('click', (e) => { e.stopPropagation(); notificationsDropdown.classList.toggle('hidden'); });
        window.addEventListener('click', () => { 
            profileDropdown.classList.add('hidden'); 
            notificationsDropdown.classList.add('hidden');
        });
        logoutBtn.addEventListener('click', () => { signOut(auth).then(() => window.location.href = '/index.html'); });


        // --- Drag and Drop Sorter Logic ---
        const items = document.querySelectorAll('.sorter-item');
        const goodBin = document.getElementById('good-bin');
        const badBin = document.getElementById('bad-bin');
        const checkSorterBtn = document.getElementById('check-sorter-btn');
        const sorterFeedback = document.getElementById('sorter-feedback');

        let draggedItem = null;

        items.forEach(item => {
            item.addEventListener('dragstart', () => {
                draggedItem = item;
                setTimeout(() => item.style.display = 'none', 0);
            });

            item.addEventListener('dragend', () => {
                setTimeout(() => {
                    draggedItem.style.display = 'block';
                    draggedItem = null;
                }, 0);
            });
        });

        [goodBin, badBin].forEach(bin => {
            bin.addEventListener('dragover', e => {
                e.preventDefault();
                bin.classList.add('drag-over');
            });
            bin.addEventListener('dragleave', () => {
                bin.classList.remove('drag-over');
            });
            bin.addEventListener('drop', () => {
                bin.append(draggedItem);
                bin.classList.remove('drag-over');
            });
        });

        checkSorterBtn.addEventListener('click', () => {
            let correct = true;
            goodBin.querySelectorAll('.sorter-item').forEach(item => {
                if (item.dataset.bin !== 'good') correct = false;
            });
            badBin.querySelectorAll('.sorter-item').forEach(item => {
                if (item.dataset.bin !== 'bad') correct = false;
            });

            if (correct && goodBin.children.length === 3 && badBin.children.length === 2) {
                sorterFeedback.textContent = "Perfect! You've correctly identified the security best practices.";
                sorterFeedback.className = 'mt-4 text-sm font-medium text-green-600';
            } else {
                sorterFeedback.textContent = "Not quite. Review the items and try sorting them again.";
                 sorterFeedback.className = 'mt-4 text-sm font-medium text-red-600';
            }
        });
    </script>
</body>
</html>

